/*! Form Submitter v1.0 | Â©2013-2016 GestiXi | Licensed under the MIT license */
!function(f){f.fn.formSubmitter=function(a){return this.each(function(){var b=f(this),c="FORM"===b[0].tagName?b.parent().find("form"):b.find("form"),e=c.data("formSubmitter");if(e)console.warn("formSubmitter is already handling the form");else{var d=f.extend({},f.fn.formSubmitter.defaults,"object"==typeof a&&a);c.data("formSubmitter",e=new g(this,c,d));c.find("input[type=submit]").on("click touchstart",function(){c.find("input[type=submit]").removeAttr("clicked");f(this).attr("clicked","true")});
c.on("submit",function(a){a.preventDefault();if(d.willSend.call(e,a)){var b=f("input[type=submit][clicked=true]");b.prop("disabled",!0);e.clickedButton=b;e.handler(a);d.didSend.call(e,a)}})}})};f.fn.formSubmitter.defaults={willSend:function(a){return!0},formSettings:function(a){a=this.$form;return{method:a.attr("method"),url:a.attr("action"),data:a.serialize()}},didSend:function(a){},willReceive:function(a){return JSON.parse(a)},didReceive:function(a,b){},notificationLayout:"position:fixed;top:10px;left:10px;width:350px;z-index:1000;"};
var g=function(a,b,c){this.element=a;this.$form=b;this.options=c};f.fn.formSubmitter.Constructor=g;g.prototype={constructor:g,element:null,$form:null,options:null,handler:function(a){var b=this,c=this.options;a=c.formSettings.call(this,a);f.ajax(a).done(function(a){var d=b.clickedButton;d&&d.prop("disabled",!1);if(a=c.willReceive.call(b,a))d=b.handleResponse(a),c.didReceive.call(b,a,d)});return!1},handleResponse:function(a){var b=this.$form,c=a.notification,e=a.helpInline,d=a.submitForm,g=a.redirectUrl;
g&&(document.location.href=g);d&&this.submitForm(d);f(".help-inline").html("");f(".form-group").removeClass("has-error");if(e){var e=JSON.parse(e),h;for(h in e)d=b.find(".help-inline."+h),d.html(e[h]),d.closest(".form-group").addClass("has-error")}c&&this.notify(c);return a},notify:function(a){f("#notification-container").length||f('<div id="notification-container" style="'+this.options.notificationLayout+'"></div>').appendTo("body");var b=f(a);b.hide().appendTo("#notification-container").slideDown().delay(8E3).fadeOut(400,
function(){b.remove()})},submitForm:function(a){a=JSON.parse(a);var b=document.createElement("form");b.setAttribute("method",a.method||"post");b.setAttribute("action",a.action);for(var c=0;c<a.inputs.length;c++){var e=a.inputs[c],d=document.createElement("input");d.setAttribute("type",e.type||"hidden");d.setAttribute("name",e.name);d.setAttribute("value",e.value);b.appendChild(d)}document.body.appendChild(b);b.submit()}}}(window.jQuery);